
{% extends 'diploma_orders/base.html' %}
{% load custom_filtres %}

{% block title %}{{ student.get_full_name }}{% endblock %}

{% block content %}
<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="page-title">{{ student.get_full_name }}</h1>
        <p class="page-subtitle">–°—Ç—É–¥–µ–Ω—Ç: {{ student.student_id }}</p>
    </div>
    <div>
        <a href="{% url 'diploma_orders:student_list' %}" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-2"></i>–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
        </a>
        <a href="{% url 'admin:diploma_orders_student_change' student.id %}" class="btn btn-primary ms-2">
            <i class="fas fa-edit me-2"></i>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
        </a>
    </div>
</div>
{% endblock %}
<div class="row">
    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –ø—Ä–æ—Ñ–∏–ª—å -->
    <div class="col-md-4 mb-4">
        <div class="student-profile text-center">
            {% if student.photo %}
            <img src="{{ student.photo.url }}" alt="{{ student }}" class="student-photo mb-4">
            {% else %}
            <div class="default-avatar mb-4 mx-auto">
                {{ student.first_name|first }}{{ student.last_name|first }}
            </div>
            {% endif %}
            
            <h4 class="mb-3">{{ student.get_full_name }}</h4>
            
            <div class="text-start mb-4">
                <p class="mb-2">
                    <strong><i class="fas fa-id-card me-2 text-primary"></i>–ù–æ–º–µ—Ä —Å—Ç—É–¥–±–∏–ª–µ—Ç–∞:</strong><br>
                    {{ student.student_id }}
                </p>
                
                {% if student.group %}
                <p class="mb-2">
                    <strong><i class="fas fa-users me-2 text-primary"></i>–£—á–µ–±–Ω–∞—è –≥—Ä—É–ø–ø–∞:</strong><br>
                    <span class="badge badge-primary">{{ student.group.name }}</span>
                </p>
                {% endif %}
                
                {% if student.email %}
                <p class="mb-2">
                    <strong><i class="fas fa-envelope me-2 text-primary"></i>Email:</strong><br>
                    {{ student.email }}
                </p>
                {% endif %}
                
                {% if student.phone %}
                <p class="mb-2">
                    <strong><i class="fas fa-phone me-2 text-primary"></i>–¢–µ–ª–µ—Ñ–æ–Ω:</strong><br>
                    {{ student.phone }}
                </p>
                {% endif %}
            </div>
            
            <!-- –§–æ—Ä–º–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∫–∞–∑–∞ -->
            {% if student.diploma_project %}
            <div class="border-top pt-4">
                <h5 class="mb-3"><i class="fas fa-file-contract me-2"></i>–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∫–∞–∑–∞</h5>
                <form method="post" action="{% url 'diploma_orders:generate_order' student.id %}">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label class="form-label mb-2">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç:</label>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="format" id="preview" value="preview" checked>
                            <label class="form-check-label" for="preview">
                                <i class="fas fa-eye me-2"></i>–ü—Ä–æ—Å–º–æ—Ç—Ä –≤ –±—Ä–∞—É–∑–µ—Ä–µ
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="format" id="md" value="md">
                            <label class="form-check-label" for="md">
                                <i class="fas fa-file-alt me-2"></i>–°–∫–∞—á–∞—Ç—å –∫–∞–∫ Markdown
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="format" id="docx" value="docx">
                            <label class="form-check-label" for="docx">
                                <i class="fas fa-file-word me-2"></i>–°–∫–∞—á–∞—Ç—å –∫–∞–∫ Word
                            </label>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-file-download me-2"></i>–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∫–∞–∑
                    </button>
                </form>
            </div>
            {% else %}
            <div class="alert alert-warning mt-4">
                <i class="fas fa-exclamation-triangle me-2"></i>
                –î–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–∫–∞–∑–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –¥–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏–ø–ª–æ–º–µ -->
    <div class="col-md-8">
        {% if student.diploma_project %}
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-graduation-cap me-2"></i>–î–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç</h5>
                <a href="{% url 'admin:diploma_orders_diplomaproject_change' student.diploma_project.id %}" 
                   class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-edit me-2"></i>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                </a>
            </div>
            <div class="card-body">
                <div class="mb-4">
                    <h6 class="text-primary mb-3">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h6>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <p class="mb-1"><strong>–¢–µ–º–∞ —Ä–∞–±–æ—Ç—ã:</strong></p>
                            <p class="text-muted">{{ student.diploma_project.topic }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <p class="mb-1"><strong>–°—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã:</strong></p>
                            <span class="badge {{ student.diploma_project.get_status_display_class }}">
                                {{ student.diploma_project.get_status_display }}
                            </span>
                        </div>
                    </div>
                    
                    {% if student.diploma_project.description %}
                    <div class="mb-3">
                        <p class="mb-1"><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong></p>
                        <p class="text-muted">{{ student.diploma_project.description }}</p>
                    </div>
            <div class="card mt-4">
    <div class="card-header">
        <i class="fas fa-file-contract"></i> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h6>–ë—ã—Å—Ç—Ä—ã–π –ø—Ä–∏–∫–∞–∑</h6>
                <form method="post" action="{% url 'diploma_orders:generate_order' student.pk %}">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label class="form-label">–§–æ—Ä–º–∞—Ç:</label>
                        {{ order_form.format }}
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-file-download"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∫–∞–∑
                    </button>
                </form>
            </div>
            <div class="col-md-6">
                <h6>–£–º–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä</h6>
                <p class="text-muted small">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ª—é–±—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å –ø–æ–º–æ—â—å—é —à–∞–±–ª–æ–Ω–æ–≤</p>
                <a href="{% url 'diploma_orders:generate_document' 'student' student.pk %}" 
                   class="btn btn-success w-100">
                    <i class="fas fa-magic"></i> –£–º–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
                </a>
                <div class="mt-2">
                    <a href="{% url 'diploma_orders:document_list' %}?student={{ student.pk }}" 
                       class="btn btn-outline-info w-100">
                        <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
                    {% endif %}
                </div>
                
                <div class="border-top pt-4 mb-4">
                    <h6 class="text-primary mb-3">–ù–∞—É—á–Ω—ã–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</h6>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <p class="mb-1"><strong>–§–ò–û —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è:</strong></p>
                            <p class="text-muted">{{ student.diploma_project.supervisor.get_full_name }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <p class="mb-1"><strong>–£—á–µ–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å –∏ –¥–æ–ª–∂–Ω–æ—Å—Ç—å:</strong></p>
                            <p class="text-muted">
                                {{ student.diploma_project.supervisor.academic_degree }}, 
                                {{ student.diploma_project.supervisor.position }}
                            </p>
                        </div>
                    </div>
                    {% if student.diploma_project.supervisor.email %}
                    <div class="mb-3">
                        <p class="mb-1"><strong>Email —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è:</strong></p>
                        <p class="text-muted">{{ student.diploma_project.supervisor.email }}</p>
                    </div>
                    {% endif %}
                </div>
                
                <div class="border-top pt-4">
                    <h6 class="text-primary mb-3">–°—Ä–æ–∫–∏</h6>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <p class="mb-1"><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ç–µ–º—ã:</strong></p>
                            <p class="text-muted">{{ student.diploma_project.registration_date|date:"d.m.Y" }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <p class="mb-1"><strong>–°—Ä–æ–∫ —Å–¥–∞—á–∏:</strong></p>
                            <p class="text-muted {% if student.diploma_project.deadline < today %}text-danger{% endif %}">
                                {{ student.diploma_project.deadline|date:"d.m.Y" }}
                                {% if student.diploma_project.deadline < today %}
                                <span class="badge badge-danger ms-2">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</span>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–∏–∫–∞–∑–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-history me-2"></i>–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–∏–∫–∞–∑–æ–≤</h5>
            </div>
            <div class="card-body">
                <p class="text-muted mb-0">
                    –ü—Ä–∏–∫–∞–∑—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ—Å–ª–µ –∏—Ö —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è.
                </p>
            </div>
        </div>
        {% else %}
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-exclamation-circle me-2"></i>–î–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</h5>
            </div>
            <div class="card-body text-center py-5">
                <i class="fas fa-graduation-cap fa-4x text-muted mb-4"></i>
                <h4 class="mb-3">–î–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</h4>
                <p class="text-muted mb-4">
                    –î–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω –¥–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç. 
                    –ù–∞–∑–Ω–∞—á—å—Ç–µ —Ç–µ–º—É –∏ –Ω–∞—É—á–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–∫–∞–∑–æ–≤.
                </p>
                <a href="{% url 'admin:diploma_orders_diplomaproject_add' %}?student={{ student.id }}" 
                   class="btn btn-primary">
                    <i class="fas fa-plus-circle me-2"></i>–ù–∞–∑–Ω–∞—á–∏—Ç—å –¥–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
                </a>
            </div>
        </div>
        {% endif %}
    </div>
 <div class="card mb-4 border-info">
    <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><i class="fas fa-robot me-2"></i>ü§ñ –ò–ò-–∞–Ω–∞–ª–∏–∑ –¥–∏–ø–ª–æ–º–∞</h5>
        {% if student.diploma_project.has_file %}
            <span class="badge bg-success">
                <i class="fas fa-check-circle"></i> –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω
            </span>
        {% else %}
            <span class="badge bg-warning">
                <i class="fas fa-exclamation-triangle"></i> –¢—Ä–µ–±—É–µ—Ç—Å—è —Ñ–∞–π–ª
            </span>
        {% endif %}
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-8">
                <h6 class="text-info mb-3">–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ò–ò-–∞–Ω–∞–ª–∏–∑–∞:</h6>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item border-0 px-0">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ –ì–û–°–¢
                    </li>
                    <li class="list-group-item border-0 px-0">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ä–µ—Ü–µ–Ω–∑–∏–∏
                    </li>
                    <li class="list-group-item border-0 px-0">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        –°–æ–∑–¥–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∑–∞—â–∏—Ç—ã
                    </li>
                    <li class="list-group-item border-0 px-0">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è
                    </li>
                </ul>
                
                {% with diploma=student.diploma_project %}
                    {% if diploma.has_file %}
                        {% if diploma.ai_analysis %}
                            <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ -->
                            <div class="mt-4">
                                <h6 class="text-info">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞:</h6>
                                <div class="row mt-3">
                                    <div class="col-md-4 text-center">
                                        <div class="p-3 border rounded">
                                            <h3 class="mb-0 {% if diploma.ai_analysis.format_score >= 80 %}text-success{% elif diploma.ai_analysis.format_score >= 60 %}text-warning{% else %}text-danger{% endif %}">
                                                {{ diploma.ai_analysis.format_score }}
                                            </h3>
                                            <small class="text-muted">–û—Ü–µ–Ω–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞</small>
                                        </div>
                                    </div>
                                    <div class="col-md-4 text-center">
                                        <div class="p-3 border rounded">
                                            <h3 class="mb-0 text-info">
                                                {{ diploma.ai_analysis.questions|length }}
                                            </h3>
                                            <small class="text-muted">–í–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∑–∞—â–∏—Ç—ã</small>
                                        </div>
                                    </div>
                                    <div class="col-md-4 text-center">
                                        <div class="p-3 border rounded">
                                            <h3 class="mb-0 {% if diploma.ai_analysis.review_grade == '–æ—Ç–ª–∏—á–Ω–æ' %}text-success{% elif diploma.ai_analysis.review_grade == '—Ö–æ—Ä–æ—à–æ' %}text-warning{% else %}text-danger{% endif %}">
                                                {{ diploma.ai_analysis.review_grade|default:"-" }}
                                            </h3>
                                            <small class="text-muted">–û—Ü–µ–Ω–∫–∞ —Ä–µ—Ü–µ–Ω–∑–∏–∏</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% else %}
                            <!-- –ê–Ω–∞–ª–∏–∑ –µ—â–µ –Ω–µ –ø—Ä–æ–≤–æ–¥–∏–ª—Å—è -->
                            <div class="alert alert-info mt-4">
                                <i class="fas fa-info-circle me-2"></i>
                                –ò–ò-–∞–Ω–∞–ª–∏–∑ –µ—â–µ –Ω–µ –ø—Ä–æ–≤–æ–¥–∏–ª—Å—è. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
                            </div>
                        {% endif %}
                    {% else %}
                        <!-- –§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω -->
                        <div class="alert alert-warning mt-4">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            –î–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –¥–∏–ø–ª–æ–º–∞.
                        </div>
                    {% endif %}
                {% endwith %}
            </div>
            
            <div class="col-md-4">
                <div class="border-start ps-4">
                    <h6 class="text-info mb-3">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:</h6>
                    
                    {% with diploma=student.diploma_project %}
                        <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ -->
                        <a href="{% url 'diploma_orders:upload_diploma' diploma.id %}" 
                           class="btn btn-{% if diploma.has_file %}outline-{% endif %}success w-100 mb-2">
                            <i class="fas {% if diploma.has_file %}fa-file-edit{% else %}fa-upload{% endif %} me-2"></i>
                            {% if diploma.has_file %}
                                –ó–∞–º–µ–Ω–∏—Ç—å —Ñ–∞–π–ª
                            {% else %}
                                –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
                            {% endif %}
                        </a>
                        
                        <!-- –ö–Ω–æ–ø–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å —Ñ–∞–π–ª) -->
                        {% if diploma.has_file %}
                            <a href="{% url 'diploma_orders:diploma_analysis' diploma.id %}" 
                               class="btn btn-primary w-100 mb-2">
                                <i class="fas fa-robot me-2"></i>
                                {% if diploma.ai_analysis %}
                                    –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑
                                {% else %}
                                    –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑
                                {% endif %}
                            </a>
                            
                            <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
                            {% if diploma.ai_analysis %}
                                <a href="{% url 'diploma_orders:diploma_analysis' diploma.id %}" 
                                   class="btn btn-outline-info w-100 mb-2">
                                    <i class="fas fa-chart-bar me-2"></i>
                                    –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                                </a>
                            {% endif %}
                        {% endif %}
                        
                        <!-- –ö–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ -->
                        {% if diploma.has_file %}
                            <a href="{% url 'diploma_orders:download_diploma' diploma.id %}" 
                               class="btn btn-outline-secondary w-100 mb-2">
                                <i class="fas fa-download me-2"></i>
                                –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
                            </a>
                        {% endif %}
                        
                        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ -->
                        {% if diploma.has_file %}
                            <div class="mt-3 p-3 border rounded">
                                <small class="text-muted d-block">
                                    <i class="fas fa-file me-2"></i>
                                    <strong>–¢–µ–∫—É—â–∏–π —Ñ–∞–π–ª:</strong><br>
                                    {{ diploma.file.name|basename }}
                                </small>
                                <small class="text-muted d-block mt-1">
                                    <i class="fas fa-weight me-2"></i>
                                    {{ diploma.file.size|filesizeformat }}
                                </small>
                            </div>
                        {% endif %}
                    {% endwith %}
                </div>
            </div>
        </div>
        
        <!-- –ú–∏–Ω–∏-—Å—Ç–∞—Ç—É—Å –∞–Ω–∞–ª–∏–∑–∞ -->
        {% with diploma=student.diploma_project %}
            {% if diploma.ai_analysis %}
                <div class="mt-3 pt-3 border-top">
                    <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">
                            <i class="fas fa-clock me-1"></i>
                            –û–±–Ω–æ–≤–ª–µ–Ω–æ: {{ diploma.ai_analysis.updated_at|date:"d.m.Y H:i" }}
                        </small>
                        <small class="text-muted">
                            <span class="badge bg-{% if diploma.ai_analysis.status == 'completed' %}success{% elif diploma.ai_analysis.status == 'processing' %}warning{% else %}danger{% endif %}">
                                {{ diploma.ai_analysis.get_status_display }}
                            </span>
                        </small>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</div>
<!-- ======= –ö–û–ù–ï–¶ –ù–û–í–û–ì–û –ë–õ–û–ö–ê ======= -->

<!-- –î–∞–ª—å—à–µ –∏–¥–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –ø—Ä–∏–∫–∞–∑–æ–≤ -->
<div class="card">
    <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-history me-2"></i>–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–∏–∫–∞–∑–æ–≤</h5>
    </div>
    <div class="card-body">
        <p class="text-muted mb-0">
            –ü—Ä–∏–∫–∞–∑—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ—Å–ª–µ –∏—Ö —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è.
        </p>
    </div>   
</div>
{% endwith  %}
{% block extra_css %}
<style>
/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏ –ò–ò-–∞–Ω–∞–ª–∏–∑–∞ */
.border-info {
    border-color: #0dcaf0 !important;
}

.bg-info {
    background-color: #0dcaf0 !important;
}

.list-group-item {
    border: none;
    padding: 8px 0;
}

.badge {
    font-weight: 500;
    padding: 5px 10px;
    border-radius: 10px;
}

.btn {
    border-radius: 8px;
    padding: 10px 15px;
    font-weight: 500;
}

.alert {
    border-radius: 10px;
    border: none;
}

.border {
    border-radius: 8px;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
.btn:hover {
    transform: translateY(-2px);
    transition: transform 0.2s;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞ */
.text-truncate-container {
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
</style>
{% endblock %}